# nginx/nginx.conf (เวอร์ชันสมบูรณ์)

server {
    listen 80;
    server_name localhost;
    
    # บอกให้ Nginx ไปหาไฟล์ mime.types จากที่ของมันเอง
    include /etc/nginx/mime.types;

    # ตั้งค่า Root directory ที่จะใช้เสิร์ฟไฟล์
    root /usr/share/nginx/html;
    # ตั้งค่าไฟล์เริ่มต้น
    index index.html;

    # ---- ส่วนสำหรับเสิร์ฟไฟล์ Frontend ----
    
    # Location หลักสำหรับจัดการ Request หน้าเว็บ (HTML)
    location / {
        try_files $uri $uri.html /index.html;
    }

    # Location สำหรับเสิร์ฟไฟล์ JavaScript โดยเฉพาะ
    location /js/ {
        try_files $uri =404;
    }
    
    # (ถ้าในอนาคตมีไฟล์ CSS ก็เพิ่ม location /css/ { ... } ได้)

    # ---- ส่วนสำหรับเป็น API Gateway (เหมือนเดิม) ----
    location /api/ {
        location /api/register/ { proxy_pass http://user-service:8000/api/register/; }
        location /api/login/ { proxy_pass http://user-service:8000/api/login/; }
        location /api/token/refresh/ { proxy_pass http://user-service:8000/api/token/refresh/; }
        location /api/me/ { proxy_pass http://user-service:8000/api/me/; }
        location /api/users/ { proxy_pass http://user-service:8000/api/users/; }
        location /api/pets/ { proxy_pass http://pet-service:8000/api/pets/; }
        location /api/job-posts/ { proxy_pass http://job-post-service:8000/api/job-posts/; }
        location /api/proposals/ { proxy_pass http://proposal-service:8000/api/proposals/; }
        location /api/bookings/ { proxy_pass http://booking-service:8000/api/bookings/; }
        location /api/reviews/ { proxy_pass http://booking-service:8000/api/reviews/; }
    }
}