{% load static %}

<!-- nav.html (PetTech) -->
<header class="sticky top-0 z-50 text-gray-700 bg-white/80 backdrop-blur-md border-b border-gray-200 shadow-sm">
  <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between h-16">
      <!-- left -->
      <div class="flex items-center gap-8">
        <a href="{% url 'home' %}" class="flex items-center gap-2 group">
          <span class="text-xl font-bold bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent select-none">PetTech</span>
        </a>
      </div>
      <div>
        <a href="{% url 'job_post_create' %}" class="px-4 py-2 text-gray-700 hover:text-gray-900 font-medium transition-colors">ประกาศงาน</a>
        {% if request.user.is_authenticated and not request.user.caregiver_profile%}
          <a href="{% url 'caregiver_register' %}" class="px-4 py-2 text-gray-700 hover:text-gray-900 font-medium transition-colors">สมัครเป็นพี่เลี้ยงสัตว์</a>
        {% endif %}
        
      </div>
      <!-- right -->
      <div class="flex items-center gap-4">
        {% if request.user.is_authenticated and request.user.caregiver_profile %}
          <svg class="inline align-text-bottom w-[3em] h-[3em]" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M14.0488 5.53954C14.464 5.44421 14.8939 5.62231 15.1201 5.98327L16.114 7.56981C16.1942 7.69788 16.3025 7.80609 16.4305 7.88633L18.0171 8.88028C18.378 9.10642 18.5561 9.53639 18.4608 9.95153L18.0418 11.7762C18.008 11.9235 18.008 12.0765 18.0418 12.2238L18.4608 14.0485C18.5561 14.4637 18.378 14.8936 18.0171 15.1198L16.4305 16.1137C16.3025 16.194 16.1942 16.3022 16.114 16.4302L15.1201 18.0168C14.8939 18.3777 14.464 18.5558 14.0488 18.4605L12.2241 18.0415C12.0768 18.0077 11.9238 18.0077 11.7765 18.0415L9.95181 18.4605C9.53667 18.5558 9.1067 18.3777 8.88057 18.0168L7.88661 16.4302C7.80638 16.3022 7.69816 16.194 7.57009 16.1137L5.98355 15.1198C5.62259 14.8936 5.44449 14.4637 5.53983 14.0485L5.95885 12.2238C5.99267 12.0766 5.99267 11.9235 5.95885 11.7762L5.53983 9.95153C5.44449 9.53639 5.62259 9.10642 5.98355 8.88028L7.57009 7.88633C7.69816 7.80609 7.80638 7.69788 7.88661 7.56981L8.88057 5.98327C9.1067 5.62231 9.53667 5.44421 9.95181 5.53954L11.7765 5.95856C11.9238 5.99239 12.0768 5.99239 12.2241 5.95856L14.0488 5.53954Z" stroke="#5fdf4e"></path> <path d="M9.51538 12.5362L11.55 14.4846L14.4846 9.51538" stroke="#5fdf4e" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
          <p class="text-green-700">You are now Caregiver</p>
        {% endif %}
        <!-- user / auth -->
        {% if request.user.is_authenticated %}
          <div class="relative">
            <!-- Profile button -->
            <button onclick="document.getElementById('user-dropdown').classList.toggle('hidden')" class="flex items-center gap-2 text-sm rounded-lg hover:bg-gray-50 px-3 py-2 transition-all duration-200 group" >
              <span class="h-9 w-9 rounded-full bg-gradient-to-br from-green-400 to-emerald-500 flex items-center justify-center text-sm font-semibold text-white shadow-sm group-hover:shadow-md transition-shadow">
                {{ request.user.username|slice:":1"|upper }}
              </span>
              <span class="hidden sm:inline font-medium">{{ request.user.get_full_name|default:request.user.username }}</span>
              <svg class="w-4 h-4 text-gray-500 group-hover:text-gray-700 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
            </button>

            <!-- Dropdown -->
            <div id="user-dropdown" class="hidden absolute right-0 mt-2 w-52 bg-white border border-gray-200 rounded-xl shadow-lg overflow-hidden z-50 animate-fadeIn">
              <div class="py-1">
                <a href="{% url 'myprofile' %}" class="flex items-center gap-3 px-4 py-2.5 text-sm text-gray-700 hover:bg-gray-50 transition-colors">
                  <!-- <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg> -->
                  Profile
                </a>
                <a href="{% url 'myposts' %}" class="flex items-center gap-3 px-4 py-2.5 text-sm text-gray-700 hover:bg-gray-50 transition-colors">
                  <!-- <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg> -->
                  MyPost
                </a>
                <a href="{% url 'my_proposals' %}" class="flex items-center gap-3 px-4 py-2.5 text-sm text-gray-700 hover:bg-gray-50 transition-colors">
                  <!-- <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg> -->
                  My Proposals
                </a>
                <a href="{% url 'booking_list' %}" class="flex items-center gap-3 px-4 py-2.5 text-sm text-gray-700 hover:bg-gray-50 transition-colors">
                  <!-- <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg> -->
                  My Booking
                </a>
                <a href="{% url 'booking_history' %}" class="flex items-center gap-3 px-4 py-2.5 text-sm text-gray-700 hover:bg-gray-50 transition-colors">
                  <!-- <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg> -->
                  Booking History
                </a>
              </div>
              <div class="border-t border-gray-100">
                  <a href="{% url 'logout' %}" class="w-full flex items-center gap-3 px-4 py-2.5 text-sm text-red-600 hover:bg-red-50 transition-colors">
                    <!-- <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path></svg> -->
                    Logout
                  </a>
                </form>
              </div>
            </div>
          </div>
        {% else %}
          <div class="flex items-center gap-2 text-sm">
            <a href="{% url 'login' %}" class="px-4 py-2 text-green-600 hover:text-green-700 font-medium transition-colors">Login</a>
            <a href="{% url 'register' %}" class="px-4 py-2 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-lg hover:from-green-700 hover:to-emerald-700 font-medium shadow-sm hover:shadow transition-all duration-200">Register</a>
          </div>
        {% endif %}
      </div>
    </div>
  </div>
</header>

<style>
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  .animate-fadeIn {
    animation: fadeIn 0.2s ease-out;
  }
</style>

<!-- small script to close dropdown on click outside -->
<script>
  document.addEventListener('click', function(e){
    const dropdown = document.getElementById('user-dropdown');
    if (!dropdown) return;
    const button = e.target.closest('button');
    const isTrigger = button && (button.parentElement && button.parentElement.contains(dropdown) || button === dropdown);
    if (!isTrigger && !dropdown.classList.contains('hidden')) {
      dropdown.classList.add('hidden');
    }
  });
</script>